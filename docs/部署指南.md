# äº¤æ˜“æ•°æ®åˆ†æç³»ç»Ÿ - Cloudflare éƒ¨ç½²æŒ‡å—

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆæ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†å¤šç§éƒ¨ç½²æ–¹æ¡ˆï¼Œæ¨èä½¿ç”¨ **Cloudflare Workers + Pages** çš„ç»„åˆæ–¹æ¡ˆï¼Œå¯ä»¥å®ç°ï¼š
- å…¨çƒCDNåŠ é€Ÿ
- æ— æœåŠ¡å™¨æ¶æ„
- è‡ªåŠ¨æ‰©ç¼©å®¹
- æˆæœ¬ä½å»‰

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æ³¨å†ŒCloudflareè´¦å·
- è®¿é—® [Cloudflare](https://www.cloudflare.com/) æ³¨å†Œè´¦å·
- æ·»åŠ ä½ çš„åŸŸååˆ°Cloudflareï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä½¿ç”¨å…è´¹çš„ `.workers.dev` åŸŸåï¼‰

### 2. å®‰è£…å¿…è¦å·¥å…·
```bash
# å®‰è£… Node.js å’Œ npm
# å®‰è£… Wrangler CLI
npm install -g wrangler

# ç™»å½• Cloudflare
wrangler login
```

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### æ–¹æ¡ˆ1ï¼šCloudflare Workers éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. åˆ›å»ºKVå‘½åç©ºé—´
```bash
# åˆ›å»ºç”Ÿäº§ç¯å¢ƒKV
wrangler kv:namespace create "TRADING_DATA"

# åˆ›å»ºé¢„è§ˆç¯å¢ƒKV
wrangler kv:namespace create "TRADING_DATA" --preview
```

#### 2. æ›´æ–°wrangler.tomlé…ç½®
å°†åˆ›å»ºçš„KVå‘½åç©ºé—´IDå¡«å…¥ `wrangler.toml` æ–‡ä»¶ï¼š
```toml
[[env.production.kv_namespaces]]
binding = "TRADING_DATA"
id = "ä½ çš„KVå‘½åç©ºé—´ID"
preview_id = "ä½ çš„é¢„è§ˆKVå‘½åç©ºé—´ID"
```

#### 3. éƒ¨ç½²åˆ°Cloudflare Workers
```bash
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
wrangler deploy --env production

# æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
wrangler tail --env production
```

#### 4. é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰
```bash
# æ·»åŠ è‡ªå®šä¹‰åŸŸå
wrangler route add "yourdomain.com/*" trading-analyzer --env production
```

### æ–¹æ¡ˆ2ï¼šHeroku + Cloudflare åŸŸå

#### 1. éƒ¨ç½²åˆ°Heroku
```bash
# å®‰è£…Heroku CLI
# ç™»å½•Heroku
heroku login

# åˆ›å»ºåº”ç”¨
heroku create your-trading-app

# è®¾ç½®Pythonç‰ˆæœ¬
echo "python-3.10.12" > runtime.txt

# éƒ¨ç½²
git add .
git commit -m "Deploy to Heroku"
git push heroku main
```

#### 2. é…ç½®CloudflareåŸŸå
1. åœ¨Cloudflare DNSè®¾ç½®ä¸­æ·»åŠ CNAMEè®°å½•
2. æŒ‡å‘ä½ çš„Herokuåº”ç”¨åŸŸå

### æ–¹æ¡ˆ3ï¼šVercel + Cloudflare åŸŸå

#### 1. åˆ›å»ºvercel.jsoné…ç½®
```json
{
  "functions": {
    "web/app.py": {
      "runtime": "python3.9"
    }
  },
  "routes": [
    { "src": "/(.*)", "dest": "/web/app.py" }
  ]
}
```

#### 2. éƒ¨ç½²åˆ°Vercel
```bash
# å®‰è£…Vercel CLI
npm install -g vercel

# éƒ¨ç½²
vercel --prod
```

## ğŸ”’ ç¯å¢ƒå˜é‡é…ç½®

### Cloudflare Workersç¯å¢ƒå˜é‡
åœ¨Cloudflare Dashboardä¸­è®¾ç½®ï¼š
- `ENVIRONMENT`: production
- `MAX_FILE_SIZE`: 16777216 (16MB)

### Herokuç¯å¢ƒå˜é‡
```bash
heroku config:set ENVIRONMENT=production
heroku config:set MAX_FILE_SIZE=16777216
```

## ğŸ“Š æ•°æ®å­˜å‚¨æ–¹æ¡ˆ

### Cloudflare KVå­˜å‚¨
- é€‚åˆå°æ–‡ä»¶å’Œé…ç½®æ•°æ®
- å…¨çƒåˆ†å¸ƒå¼å­˜å‚¨
- å…è´¹é¢åº¦ï¼š100,000æ¬¡è¯»å–/å¤©ï¼Œ1,000æ¬¡å†™å…¥/å¤©

### Cloudflare R2å­˜å‚¨ï¼ˆæ¨èå¤§æ–‡ä»¶ï¼‰
```bash
# åˆ›å»ºR2å­˜å‚¨æ¡¶
wrangler r2 bucket create trading-data

# åœ¨wrangler.tomlä¸­é…ç½®
[[r2_buckets]]
binding = "TRADING_FILES"
bucket_name = "trading-data"
```

## ğŸŒ åŸŸåé…ç½®

### ä½¿ç”¨Cloudflareç®¡ç†åŸŸå
1. å°†åŸŸåDNSæœåŠ¡å™¨æŒ‡å‘Cloudflare
2. åœ¨Cloudflare DNSä¸­é…ç½®è®°å½•ï¼š
   ```
   Type: CNAME
   Name: @
   Content: your-app.workers.dev
   Proxy: å·²å¯ç”¨
   ```

### SSL/TLSé…ç½®
- Cloudflareè‡ªåŠ¨æä¾›å…è´¹SSLè¯ä¹¦
- å»ºè®®ä½¿ç”¨"å®Œå…¨(ä¸¥æ ¼)"æ¨¡å¼

## ğŸ”§ æœ¬åœ°å¼€å‘

### å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
```bash
# Cloudflare Workersæœ¬åœ°å¼€å‘
wrangler dev --env production

# Flaskåº”ç”¨æœ¬åœ°å¼€å‘
python web/app.py
```

### æµ‹è¯•éƒ¨ç½²
```bash
# æµ‹è¯•Workerséƒ¨ç½²
wrangler dev --local

# æµ‹è¯•ä¸Šä¼ åŠŸèƒ½
curl -X POST -F "file=@data/äº¤æ˜“æ•°æ®.xlsx" http://localhost:8787/api/upload
```

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### Cloudflare Analytics
- è®¿é—®Cloudflare DashboardæŸ¥çœ‹è¯·æ±‚ç»Ÿè®¡
- ç›‘æ§é”™è¯¯ç‡å’Œå“åº”æ—¶é—´

### æ—¥å¿—æŸ¥çœ‹
```bash
# å®æ—¶æŸ¥çœ‹Workersæ—¥å¿—
wrangler tail --env production

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µæ—¥å¿—
wrangler tail --env production --since 2025-01-01
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶
   - ç¡®è®¤KVå­˜å‚¨é…ç½®æ­£ç¡®

2. **æ•°æ®å¤„ç†è¶…æ—¶**
   - Workersæœ‰CPUæ—¶é—´é™åˆ¶
   - è€ƒè™‘å°†å¤æ‚å¤„ç†ç§»åˆ°å¤–éƒ¨API

3. **åŸŸåè®¿é—®å¤±è´¥**
   - æ£€æŸ¥DNSé…ç½®
   - ç¡®è®¤SSLè¯ä¹¦çŠ¶æ€

### è°ƒè¯•å‘½ä»¤
```bash
# æ£€æŸ¥WorkersçŠ¶æ€
wrangler status

# æŸ¥çœ‹KVæ•°æ®
wrangler kv:key list --binding TRADING_DATA

# æµ‹è¯•APIç«¯ç‚¹
curl -X GET https://your-domain.com/api/dashboard
```

## ğŸ’° æˆæœ¬ä¼°ç®—

### Cloudflare Workers
- å…è´¹é¢åº¦ï¼š100,000æ¬¡è¯·æ±‚/å¤©
- ä»˜è´¹ï¼š$5/æœˆèµ·ï¼Œ1000ä¸‡æ¬¡è¯·æ±‚

### å­˜å‚¨æˆæœ¬
- KVå­˜å‚¨ï¼šå…è´¹é¢åº¦é€šå¸¸è¶³å¤Ÿ
- R2å­˜å‚¨ï¼š$0.015/GB/æœˆ

### æ€»æˆæœ¬
- å°å‹åº”ç”¨ï¼šå…è´¹
- ä¸­å‹åº”ç”¨ï¼š$5-20/æœˆ
- å¤§å‹åº”ç”¨ï¼šæ ¹æ®ä½¿ç”¨é‡è®¡è´¹

## ğŸ”„ æŒç»­éƒ¨ç½²

### GitHub Actionsè‡ªåŠ¨éƒ¨ç½²
åˆ›å»º `.github/workflows/deploy.yml`ï¼š
```yaml
name: Deploy to Cloudflare Workers

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Deploy to Cloudflare Workers
      uses: cloudflare/wrangler-action@2.0.0
      with:
        apiToken: ${{ secrets.CF_API_TOKEN }}
        environment: 'production'
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹Cloudflareæ–‡æ¡£
2. æ£€æŸ¥é¡¹ç›®GitHub Issues
3. è”ç³»æŠ€æœ¯æ”¯æŒ

---

é€‰æ‹©æœ€é€‚åˆä½ éœ€æ±‚çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œå¼€å§‹äº«å—äº‘ç«¯äº¤æ˜“æ•°æ®åˆ†æå§ï¼ğŸ‰