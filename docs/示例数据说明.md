# 交易数据处理程序 - 示例数据说明

## 概述

本程序用于处理交易数据、费率配置和收盘价格，生成盈亏分析、交易明细和持仓数据。

## 输入文件

程序需要以下三个Excel文件作为输入：

1. **交易数据.xlsx**：包含交易记录
   - 必要列：日期、证券代码、证券名称、买卖方向、成交价格、成交数量、市场、券商
   - 可选列：产品类型（如果没有，程序会根据证券代码推断）

2. **费率配置.xlsx**：包含各市场、各券商的费率设置
   - 必要列：券商、市场、产品类型、手续费率、印花税率、过户费率、最低手续费、平台使用费、结算费、汇率费、监管费

3. **收盘价格.xlsx**：包含各证券的收盘价数据
   - 必要列：日期、证券代码、证券名称、收盘价
   - 如果当天收盘价格为空或者无记录，程序会使用0作为当天的收盘价

## 输出文件

程序会生成以下三个Excel文件作为输出：

1. **盈亏分析.xlsx**：包含每日盈亏分析
   - 包含列：日期、证券代码、持仓市值、持仓数量、持仓成本价、每日盈亏、累计总盈亏

2. **交易明细.xlsx**：包含交易明细和费用计算
   - 包含列：日期、证券代码、证券名称、买卖方向、成交价格、成交数量、市场、券商、产品类型、交易金额、手续费、印花税、过户费、平台使用费、结算费、汇率费、监管费、总费用

3. **持仓数据.xlsx**：包含当前持仓情况
   - 包含列：证券代码、证券名称、市场、产品类型、持仓数量、持仓成本、当前价格、持仓市值、累计盈亏

## 使用方法

1. 准备好三个输入文件：交易数据.xlsx、费率配置.xlsx、收盘价格.xlsx
2. 运行程序：`python trading_processor.py`
3. 查看生成的输出文件：盈亏分析.xlsx、交易明细.xlsx、持仓数据.xlsx

## 创建示例数据

可以使用 `create_sample.py` 脚本创建示例数据：

```bash
python create_sample.py
```

这将生成三个示例输入文件，可用于测试程序功能。